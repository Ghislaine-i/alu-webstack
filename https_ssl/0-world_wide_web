#!/usr/bin/env bash
# Display information about subdomains

domain=$1
subdomain=$2

get_info() {
    sub=$1
    dom=$2
    result=$(dig +short "${sub}.${dom}" | head -n1)
    if [ -n "$result" ]; then
        record_type=$(dig "${sub}.${dom}" | awk '/ANSWER SECTION/,/^$/ {if ($4 != "" && $4 != "ANSWER") print $4}' | head -n1)
        echo "The subdomain ${sub} is a ${record_type} record and points to ${result}"
    fi
}

if [ -z "$subdomain" ]; then
    get_info "www" "$domain"
    get_info "lb-01" "$domain"
    get_info "web-01" "$domain"
    get_info "web-02" "$domain"
else
    get_info "$subdomain" "$domain"
fi
