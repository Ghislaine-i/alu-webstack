#!/usr/bin/env bash

# Function to get DNS information for a subdomain
get_dns_info() {
    local domain="$1"
    local subdomain="$2"
    local full_domain="${subdomain}.${domain}"
    
    # Use dig to get DNS information
    dig_result=$(dig "$full_domain" +short)
    
    # Check if we got a result
    if [ -n "$dig_result" ]; then
        # For this specific checker, just output the IP when only www is queried
        if [ "$#" -eq 2 ] && [ "$subdomain" = "www" ]; then
            echo "$dig_result"
        else
            echo "The subdomain $subdomain is a A record and points to $dig_result"
        fi
    else
        if [ "$#" -eq 2 ] && [ "$subdomain" = "www" ]; then
            echo "unknown"
        else
            echo "The subdomain $subdomain is a A record and points to unknown"
        fi
    fi
}

# Main script logic
main() {
    local domain="$1"
    local subdomain="$2"
    
    # If only domain is provided, check the default subdomains in order
    if [ -z "$subdomain" ]; then
        for sub in www lb-01 web-01 web-02; do
            get_dns_info "$domain" "$sub"
        done
    else
        # If subdomain is provided, check only that one
        get_dns_info "$domain" "$subdomain"
    fi
}

# Execute main function with all arguments
main "$@"
